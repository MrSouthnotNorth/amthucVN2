<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>·∫®m th·ª±c Vi·ªát Nam</title>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Nunito:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root{
            --accent:#7aa26b;
            --muted:#f5f3ef;
            --card:#fff;
            --glass: rgba(255,255,255,0.85);
            --radius:14px;
            --shadow: 0 6px 18px rgba(0,0,0,0.08);
            --transition: 300ms cubic-bezier(.2,.9,.3,1);
        }
        *{box-sizing:border-box}
        body{
            margin:0;
            font-family: "Nunito",system-ui,Segoe UI, Roboto, "Helvetica Neue", Arial;
            background: linear-gradient(180deg,#fffef8 0%, #f7f7f5 100%);
            color:#222;
            -webkit-font-smoothing:antialiased;
        }

        /* Header */
        header{
            display:flex;
            align-items:center;
            gap:20px;
            padding:18px 24px;
            position:relative;
            background: linear-gradient(90deg, rgba(250,248,243,0.9), rgba(255,255,255,0.6));
            border-bottom:1px solid #eee;
            z-index:10;
        }
        .logo{
            width:64px;height:64px;border-radius:8px;overflow:hidden;
            background:linear-gradient(45deg,#e6f1df,#cfe8c1);
            display:flex;align-items:center;justify-content:center;
            flex:0 0 64px; border:2px solid rgba(0,0,0,0.04);
        }
        .logo img{width:100%;height:100%;object-fit:cover;display:block}
        h1{
            margin:0;
            flex:1;
            text-align:center;
            font-family:"Merriweather", serif;
            font-weight:700;
            font-size:28px;
            color:#3b4b2f;
            text-shadow: 0 1px 0 rgba(255,255,255,0.6);
            letter-spacing:0.6px;
        }
        header .dec{
            width:64px;height:64px;opacity:0.9;background:transparent;
            display:flex;align-items:center;justify-content:center;
            color:var(--accent);font-size:20px;
        }

        /* Carousel */
        .hero{
            padding:18px;
            display:flex;
            justify-content:center;
        }
        .carousel{
            width:100%;
            max-width:1100px;
            height:360px;
            overflow:hidden;
            border-radius:16px;
            box-shadow: var(--shadow);
            position:relative;
            background:linear-gradient(180deg,#efe8dc,#fff);
        }
        .slides{
            display:flex;
            height:100%;
            transition: transform 700ms ease;
            will-change: transform;
        }
        .slide{
            flex:0 0 100%;
            height:100%;
            position:relative;
            overflow:hidden;
        }
        .slide img{
            width:100%;
            height:100%;
            object-fit:cover;
            display:block;
            transition: transform 600ms var(--transition);
        }
        .slide:hover img{ transform: scale(1.04); }
        .slide::after{
            content:"";
            position:absolute;
            inset:0;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(255,255,255,0.03) 0 15%, transparent 15%),
                linear-gradient(180deg, rgba(255,255,255,0.02), transparent 40%);
            pointer-events:none;
        }
        .carousel-controls{
            position:absolute;
            left:12px;right:12px;bottom:12px;
            display:flex;justify-content:space-between;align-items:center;
            pointer-events:none;
        }
        .dots{display:flex;gap:8px;pointer-events:auto}
        .dot{
            width:10px;height:10px;border-radius:10px;background:rgba(0,0,0,0.12);
            transition:all 220ms;
        }
        .dot.active{background:var(--accent);transform:scale(1.15)}
        .control-btn{
            pointer-events:auto;background:rgba(255,255,255,0.85);border-radius:10px;padding:8px;
            box-shadow:var(--shadow);cursor:pointer;border:0;
        }

        /* Tabs menu */
        nav.tabs{
            margin:18px auto 6px;
            max-width:1100px;
            display:flex;
            gap:8px;flex-wrap:wrap;
            padding:8px;
        }
        nav.tabs button{
            background:var(--glass);
            border:1px solid rgba(0,0,0,0.06);
            padding:10px 14px;border-radius:12px;
            cursor:pointer;font-weight:600;color:#333;
            transition:all 180ms;
        }
        nav.tabs button.active{background:var(--accent);color:#fff;transform:translateY(-3px)}
        .content{
            max-width:1100px;margin:12px auto;padding:18px;background:transparent;
        }
        .pane{display:none}
        .pane.active{display:block}

        /* Intro */
        .intro{
            display:flex;gap:18px;align-items:center;
            background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.4));
            padding:16px;border-radius:12px;box-shadow:var(--shadow);
        }
        .intro img{width:220px;height:140px;object-fit:cover;border-radius:10px}
        .intro .txt{flex:1;color:#333}

        /* Menu grid */
        .searchbar{display:flex;gap:10px;align-items:center;margin:10px 0}
        .searchbar input{
            flex:1;padding:10px 12px;border-radius:10px;border:1px solid #e3e3e3;background:#fff;
        }
        .grid{
            display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;margin-top:12px;
        }
        .card{
            background:var(--card);border-radius:12px;padding:10px;box-shadow:var(--shadow);
            transition:transform 260ms,var(--transition);
            cursor:pointer;border:1px solid rgba(0,0,0,0.03);
            display:flex;flex-direction:column;gap:10px;
        }
        .card:hover{transform:translateY(-6px)}
        .card .imgwrap{
            height:140px;border-radius:10px;overflow:hidden;
        }
        .card img{width:100%;height:100%;object-fit:cover;display:block;transition:transform 300ms}
        .card:hover img{transform:scale(1.1)} /* zoom 10% on hover */
        .card h3{margin:0;font-size:16px;color:#2c3b2b}
        .card p{margin:0;color:#566;flex:1;font-size:13px}

        /* modal */
        .modal{
            position:fixed;inset:0;display:none;align-items:center;justify-content:center;
            background:rgba(0,0,0,0.4);z-index:50;padding:20px;
        }
        .modal.active{display:flex}
        .dialog{
            width:100%;max-width:820px;background:#fff;border-radius:14px;padding:18px;box-shadow:0 18px 60px rgba(0,0,0,0.3);
            max-height:90vh;overflow:auto;
        }
        .dialog .top{display:flex;gap:14px}
        .dialog .top img{width:260px;height:160px;object-fit:cover;border-radius:10px}
        .dialog h2{margin:0 0 6px}
        .variants, .toppings{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
        .chip{background:#f2f7ef;padding:6px 10px;border-radius:999px;border:1px solid rgba(0,0,0,0.04);font-size:13px}
        .chip-preview{
            position:absolute;
            bottom:calc(100% + 8px);
            left:50%;
            transform:translateX(-50%) scale(0.9);
            width:100px;
            height:75px;
            border-radius:8px;
            box-shadow:var(--shadow);
            pointer-events:none;
            opacity:0;
            transition: all 200ms cubic-bezier(.2,.9,.3,1);
        }
        .comments{
            margin-top:14px;border-radius:10px;padding:10px;background:#fafafa;border:1px solid #eee;
            max-height:180px;overflow:auto;
        }
        .cmt{padding:8px;border-bottom:1px dashed rgba(0,0,0,0.04);font-size:14px}
        .cmt:last-child{border-bottom:0}
        .comment-preview{ display:flex; align-items:center; gap:10px; margin-top:8px; }
        .comment-preview .cavatar{
            width:44px; height:44px; min-width:44px; border-radius:50%;
            background:linear-gradient(180deg,var(--accent), #5f9b6a);
            color:#fff; display:grid; place-items:center; font-weight:700; font-size:16px;
            box-shadow:var(--shadow);
        }
        .comment-preview .cmeta{ flex:1; background:#fff; padding:8px 10px; border-radius:8px; box-shadow:var(--shadow); font-size:13px; color:#333; }
        .comment-preview .cmeta .cname{ font-weight:700; font-size:13px; color:#2c3b2b; margin-bottom:4px; }
        .comment-preview .cmeta .ctext{
            font-size:13px;
            color:#444;
            max-height:48px;
            height:48px;
            overflow:auto;
            scroll-behavior:smooth;
            scroll-snap-type:y mandatory;
            -webkit-overflow-scrolling: touch;
        }
        .comment-preview .cmeta .ctext::-webkit-scrollbar{ width:8px; height:6px; }
        .comment-preview .cmeta .ctext::-webkit-scrollbar-thumb{ background:rgba(0,0,0,0.08); border-radius:8px; }
        .comment-preview .cmeta .ctext .citem{
            scroll-snap-align:start;
            min-height:48px;
            display:flex;
            align-items:center;
            padding:2px 0;
            line-height:1.2;
        }
         .card .comment-preview{ margin-top:auto }
        .coming{padding:30px;text-align:center;color:#666;background:linear-gradient(180deg,#fff,#fbfbfb);border-radius:12px;border:1px dashed #eee}
        @keyframes fadeInUp{ from{ opacity:0; transform: translateY(12px)} to{ opacity:1; transform: translateY(0)} }
        .reveal{ animation: fadeInUp 520ms var(--transition) both; animation-delay: var(--d, 0ms); }
        .slides, .slide, .slide img{ user-select:none; -webkit-user-select:none; -ms-user-select:none; -webkit-user-drag:none; }
        .carousel.grabbing{ cursor:grabbing; }

        @media (max-width:700px){
            .intro{flex-direction:column}
            .dialog .top{flex-direction:column}
            .dialog .top img{width:100%;height:200px}
            h1{font-size:22px}
            .carousel{height:240px}
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <img src="images/logo/logo.png" alt="logo">
        </div>
        <h1>·∫®m th·ª±c Vi·ªát Nam</h1>
        <div class="dec" title="Trang tr√≠">üèØ</div>
    </header>

    <section class="hero">
        <div class="carousel reveal" id="carousel">
            <div class="slides" id="slides">
                <div class="slide"><img src="images/Banner/banner-slide-1.jpg" alt></div>
                <div class="slide"><img src="images/Banner/banner-slide-2.jpg" alt></div>
                <div class="slide"><img src="images/Banner/banner-slide-3.jpg" alt></div>
                <div class="slide"><img src="images/Banner/banner-slide-4.jpg" alt></div>
                <div class="slide"><img src="images/Banner/banner-slide-5.jpg" alt></div>
                <div class="slide"><img src="images/Banner/banner-slide-6.jpg" alt></div>
                <div class="slide"><img src="images/Banner/banner-slide-7.jpg" alt></div>
            </div>

            <div class="carousel-controls">
                <div class="left-controls" style="display:flex;gap:8px;">
                    <button class="control-btn" id="prev" title="Tr∆∞·ªõc">‚óÄ</button>
                    <button class="control-btn" id="next" title="Ti·∫øp">‚ñ∂</button>
                </div>
                <div class="dots" id="dots"></div>
            </div>
        </div>
    </section>

    <nav class="tabs" role="tablist" aria-label="Main menu">
        <button class="tab-btn active" data-target="intro">Gi·ªõi thi·ªáu</button>
        <button class="tab-btn" data-target="menu">Th·ª±c ƒë∆°n</button>
        <button class="tab-btn" data-target="reviews">ƒê√°nh gi√°</button>
        <button class="tab-btn" data-target="order">ƒê·∫∑t h√†ng</button>
        <button class="tab-btn" data-target="contact">Li√™n h·ªá</button>
        <button class="tab-btn" data-target="support">H·ªó tr·ª£</button>
    </nav>

    <main class="content">
        <section id="intro" class="pane active">
            <div class="intro reveal">
                <img src="images/introduce/introduce-slide-1.jpg" alt="Tinh t·∫ø c·ªßa h∆∞∆°ng v·ªã">
                <div class="txt">
                    <h3>·∫®m th·ª±c VI·ªÜT NAM-B·∫£n giao h∆∞·ªüng tinh t·∫ø c·ªßa h∆∞∆°ng v·ªã</h3>
                    <p>
                        ·∫®m th·ª±c Vi·ªát Nam t·ª´ l√¢u ƒë√£ v∆∞·ª£t ra kh·ªèi bi√™n gi·ªõi qu·ªëc gia ƒë·ªÉ tr·ªü th√†nh m·ªôt trong nh·ªØng n·ªÅn ·∫©m th·ª±c ƒë∆∞·ª£c y√™u m·∫øn v√† ƒë√°nh gi√° cao nh·∫•t tr√™n th·∫ø gi·ªõi. ƒê√≥ kh√¥ng ch·ªâ ƒë∆°n thu·∫ßn l√† nh·ªØng m√≥n ƒÉn ngon, m√† l√† m·ªôt di s·∫£n vƒÉn h√≥a k·∫øt tinh t·ª´ l·ªãch s·ª≠ l√¢u ƒë·ªùi, s·ª± ƒëa d·∫°ng ƒë·ªãa l√Ω v√† tri·∫øt l√Ω s·ªëng h√†i h√≤a c·ªßa ng∆∞·ªùi Vi·ªát.
                    </p>
                </div>
            </div>
            <div class="intro reveal">
                <img src="images/introduce/introduce-slide-2.jpg" alt="C√¢n b·∫±ng trong gia v·ªã">
                <div class="txt">
                    <h3>·∫®m th·ª±c VI·ªÜT NAM-Tri·∫øt l√Ω c√¢n b·∫±ng trong gia v·ªã</h3>
                    <p>
                        ƒêi·ªÉm ƒë·∫∑c s·∫Øc l√†m n√™n "linh h·ªìn" c·ªßa ·∫©m th·ª±c Vi·ªát l√† tri·∫øt l√Ω c√¢n b·∫±ng √Çm - D∆∞∆°ng. M·ªói m√≥n ƒÉn ƒë·ªÅu l√† m·ªôt s·ª± ph·ªëi tr·ªôn h√†i h√≤a c·ªßa ng≈© v·ªã (chua, cay, m·∫∑n, ng·ªçt, ƒë·∫Øng) v√† ng≈© s·∫Øc (tr·∫Øng, xanh, v√†ng, ƒë·ªè, ƒëen), kh√¥ng ch·ªâ k√≠ch th√≠ch v·ªã gi√°c m√† c√≤n t·∫°o n√™n m·ªôt t·ªïng th·ªÉ b·ªï d∆∞·ª°ng cho s·ª©c kh·ªèe. S·ª± c√¢n b·∫±ng n√†y th·ªÉ hi·ªán ·ªü vi·ªác c√°c nguy√™n li·ªáu mang t√≠nh "h√†n" (l·∫°nh) lu√¥n ƒë∆∞·ª£c k·∫øt h·ª£p v·ªõi c√°c gia v·ªã mang t√≠nh "nhi·ªát" (n√≥ng) v√† ng∆∞·ª£c l·∫°i, t·∫°o n√™n s·ª± qu√¢n b√¨nh ho√†n h·∫£o.
                    </p>
                </div>
            </div>
            <div class="intro reveal">
                <img src="images/introduce/introduce-slide-3.jpg" alt="Thi√™n ƒë∆∞·ªùng trong ·∫©m th·ª±c">
                <div class="txt">
                    <h3>·∫®m th·ª±c VI·ªÜT NAM-Thi√™n ƒë∆∞·ªùng c·ªßa ·∫©m th·ª±c</h3>
                    <p>
                        M·ªôt trong nh·ªØng y·∫øu t·ªë chinh ph·ª•c th·ª±c kh√°ch qu·ªëc t·∫ø ch√≠nh l√† vi·ªác s·ª≠ d·ª•ng v√¥ v√†n c√°c lo·∫°i rau th∆°m v√† nguy√™n li·ªáu t∆∞∆°i m·ªõi. Hi·∫øm c√≥ n·ªÅn ·∫©m th·ª±c n√†o m√† rau s·ªëng, th·∫£o m·ªôc (nh∆∞ h√∫ng qu·∫ø, ng√≤ r√≠, t√≠a t√¥, kinh gi·ªõi...) l·∫°i ƒë√≥ng vai tr√≤ quan tr·ªçng v√† ƒëa d·∫°ng ƒë·∫øn v·∫≠y. Ch√∫ng kh√¥ng ch·ªâ l√† ƒë·ªì trang tr√≠ m√† l√† th√†nh ph·∫ßn ch·ªß ƒë·∫°o, mang ƒë·∫øn s·ª± thanh m√°t, b√πng n·ªï h∆∞∆°ng th∆°m v√† l√†m gi·∫£m ƒë·ªô ng·∫•y c·ªßa c√°c m√≥n chi√™n, n∆∞·ªõng hay gi√†u ƒë·∫°m.
                        C√°c m√≥n ƒÉn Vi·ªát, ƒë·∫∑c bi·ªát l√† c√°c lo·∫°i n∆∞·ªõc d√πng (nh∆∞ Ph·ªü, B√∫n B√≤ Hu·∫ø), n·ªïi ti·∫øng v·ªõi s·ª± trong tr·∫ªo, thanh tao nh∆∞ng l·∫°i s√¢u s·∫Øc v·ªÅ h∆∞∆°ng v·ªã, k·∫øt qu·∫£ c·ªßa qu√° tr√¨nh ninh x∆∞∆°ng v√† th·∫£o m·ªôc c√¥ng phu h√†ng gi·ªù li·ªÅn.
                    </p>
                </div>
            </div>
            <div class="intro reveal">
                <img src="images/introduce/introduce-slide-4.jpg" alt="ƒëa d·∫°ng b·∫£n s·∫Øc d√¢n t·ªôc trong ·∫©m th·ª±c">
                <div class="txt">
                    <h3>·∫®m th·ª±c VI·ªÜT NAM-S·ª± ƒëa d·∫°ng b·∫£n s·∫Øc</h3>
                    <p>
                        ·∫®m th·ª±c Vi·ªát Nam l√† m·ªôt b·ª©c tranh ƒëa s·∫Øc m√†u v·ªõi ba phong c√°ch ƒë·∫∑c tr∆∞ng c·ªßa ba mi·ªÅn:

·∫®m th·ª±c mi·ªÅn B·∫Øc: Ch√∫ tr·ªçng s·ª± tinh t·∫ø, thanh tao v·ªõi kh·∫©u v·ªã v·ª´a v·∫∑n, kh√¥ng qu√° n·ªìng g·∫Øt. ƒê√¢y l√† n∆°i khai sinh ra nh·ªØng "qu·ªëc h·ªìn qu·ªëc t√∫y" nh∆∞ Ph·ªü H√† N·ªôi, B√∫n Ch·∫£, Ch·∫£ C√° L√£ V·ªçng.

·∫®m th·ª±c mi·ªÅn Trung: N·ªïi b·∫≠t v·ªõi h∆∞∆°ng v·ªã ƒë·∫≠m ƒë√†, m·∫°nh m·∫Ω v√† thi√™n v·ªÅ v·ªã cay n·ªìng. V√πng ƒë·∫•t c·ªë ƒë√¥ Hu·∫ø ƒë√£ ƒë√≥ng g√≥p cho n·ªÅn ·∫©m th·ª±c s·ª± c·∫ßu k·ª≥, tinh x·∫£o trong c·∫£ h∆∞∆°ng v·ªã l·∫´n c√°ch tr√¨nh b√†y (nh∆∞ B√∫n B√≤ Hu·∫ø, B√°nh B·ªôt L·ªçc, C∆°m H·∫øn).

·∫®m th·ª±c mi·ªÅn Nam: Ch·ªãu ·∫£nh h∆∞·ªüng c·ªßa s·ª± giao thoa vƒÉn h√≥a, mang ƒë·∫øn h∆∞∆°ng v·ªã ph√≥ng kho√°ng, ng·ªçt ng√†o (t·ª´ ƒë∆∞·ªùng, n∆∞·ªõc c·ªët d·ª´a) v√† ƒëa d·∫°ng (nh∆∞ B√°nh X√®o, G·ªèi Cu·ªën, H·ªß Ti·∫øu Nam Vang).
                    </p>
                </div>
            </div>
        </section>

        <section id="menu" class="pane">
            <div style="display:flex;flex-direction:column">
                <div class="searchbar">
                    <input id="search" placeholder="T√¨m m√≥n (v√≠ d·ª•: Ph·ªü, B√°nh M√¨...)">
                    <div style="width:130px;text-align:right;color:#666;font-size:14px">K√©o ƒë·ªÉ xem th√™m</div>
                </div>

                <div class="grid" id="menuGrid">
                </div>
            </div>
        </section>

        <section id="reviews" class="pane">
            <h3>ƒê√°nh gi√° ng∆∞·ªùi d√πng</h3>
            <div class="review-list" id="reviewList">
            </div>
        </section>

        <section id="order" class="pane">
            <div class="coming">ƒêang trong qu√° tr√¨nh ho√†n thi·ªán, xin th√¥ng c·∫£m.</div>
        </section>

        <section id="contact" class="pane">
            <div class="coming">ƒêang trong qu√° tr√¨nh ho√†n thi·ªán, xin th√¥ng c·∫£m.</div>
        </section>

        <section id="support" class="pane">
            <div class="coming">ƒêang trong qu√° tr√¨nh ho√†n thi·ªán, xin th√¥ng c·∫£m.</div>
        </section>
    </main>

    <div class="modal" id="modal">
        <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="dlgTitle">
            <div style="display:flex;justify-content:space-between;align-items:center">
                <div>
                    <h2 id="dlgTitle">T√™n m√≥n</h2>
                    <div id="dlgRating" style="color:#f5a623;font-weight:700;margin-top:4px"></div>
                </div>
                <button id="closeDlg" style="background:transparent;border:0;font-size:20px;cursor:pointer">‚úï</button>
            </div>
            <div class="top">
                <img id="dlgImg" url="blob:https://www.messenger.com/cdd559da-d43e-4803-a603-093feb471d44" alt="">
                <div style="flex:1">
                    <p id="dlgDesc" style="color:#444">M√¥ t·∫£ ng·∫Øn v·ªÅ m√≥n ƒÉn.</p>
                    <div style="margin-top:10px">
                        <div style="font-weight:700;color:#333;margin-bottom:6px">Bi·∫øn t·∫•u</div>
                        <div id="dlgVars" class="variants"></div>
                        <div style="font-weight:700;color:#333;margin-top:12px;margin-bottom:6px">Topping / Th√™m</div>
                        <div id="dlgTops" class="toppings"></div>
                    </div>
                </div>
            </div>

            <div style="margin-top:12px;font-weight:700">B√¨nh lu·∫≠n ti√™u bi·ªÉu</div>
            <div class="comments" id="dlgComments">
            </div>
        </div>
    </div>

    <script>
        const dishes = [
            { id:1, name:"Ph·ªü", img:"images/Menu/Pho/pho.jpg", desc:"Ph·ªü (ch·ªØ N√¥m: ¨ñæ) l√† m·ªôt m√≥n ƒÉn truy·ªÅn th·ªëng c·ªßa Vi·ªát Nam, ƒë∆∞·ª£c xem l√† m·ªôt trong nh·ªØng m√≥n ƒÉn ti√™u bi·ªÉu cho n·ªÅn ·∫©m th·ª±c Vi·ªát Nam.", variants:[{name:"Ph·ªü t√°i n·∫°m", img:"images/Menu/pho/photainam.jpg"},{name:"Ph·ªü g√†", img:"images/Menu/Pho/phoga.jpg"},{name:"Ph·ªü g·∫ßu", img:"images/Menu/Pho/phogau.jpg"}], toppings:[{name:"Chanh", img:"images/Menu/TOPPING/chanh.jpg"},{name:"·ªöt", img:"images/Menu/TOPPING/ot.jpg"},{name:"H√†nh ng√≤", img:"images/Menu/TOPPING/hanhngo.jpg"},{name:"Qu·∫©y", img:"images/Menu/TOPPING/quay.jpg"}], comments:[
                {name:"Lan", text:"Ngon chu·∫©n v·ªã!", rating:5},
                {name:"Minh", text:"N∆∞·ªõc d√πng thanh, th∆°m.", rating:5},
                {name:"An", text:"Ph·ª•c v·ª• nhanh, b√°nh ph·ªü m·ªÅm.", rating:4},
                {name:"H√†", text:"Gi√° h·ª£p l√Ω, s·∫Ω quay l·∫°i.", rating:5},
                {name:"Trung", text:"ƒê·∫≠m ƒë√†, r·∫•t v·ª´a mi·ªáng.", rating:5}
            ], rating:4.7},
            { id:2, name:"B√°nh M√¨", img:"images/Menu/BanhMi/banhmi.jpg", desc:"B√°nh m√¨ l√† m·ªôt lo·∫°i baguette c·ªßa Vi·ªát Nam v·ªõi l·ªõp v·ªè ngo√†i gi√≤n tan, ru·ªôt m·ªÅm, c√≤n b√™n trong l√† ph·∫ßn nh√¢n. T√πy theo vƒÉn h√≥a v√πng mi·ªÅn ho·∫∑c s·ªü th√≠ch c√° nh√¢n m√† ng∆∞·ªùi ta c√≥ th·ªÉ l·ª±a ch·ªçn nhi·ªÅu lo·∫°i ƒë·ªì ƒÉn k√®m kh√°c nhau, ngo√†i ra t√™n g·ªçi c·ªßa b√°nh c≈©ng ph·ª• thu·ªôc ph·∫ßn l·ªõn v√†o nh·ªØng bi·∫øn t·∫•u ·∫•y. Tuy nhi√™n, nh·ªØng phi√™n b·∫£n ph·ªï bi·∫øn nh·∫•t v·∫´n th∆∞·ªùng ch·ª©a ch·∫£ l·ª•a, th·ªãt, ho·∫∑c th·ª±c ph·∫©m chay, k√®m theo m·ªôt s·ªë nguy√™n li·ªáu ph·ª• kh√°c nh∆∞ pa t√™, b∆°, rau, ·ªõt, tr·ª©ng v√† ƒë·ªì chua.", variants:[{name:"B√°nh m√¨ ch·∫£", img:"images/Menu/BanhMi/banhmicha.jpg"},{name:"B√°nh m√¨ th·ªãt", img:"images/Menu/BanhMi/banhmithit.jpg"}], toppings:[{name:"Pate", img:"images/Menu/TOPPING/pate.jpg"},{name:"·ªöt", img:"images/Menu/TOPPING/ot.jpg"},{name:"Rau th∆°m", img:"images/Menu/TOPPING/rauthom.jpg"}], comments:[
                {name:"Ph√∫c", text:"B√°nh gi√≤n, nh√¢n ngon.", rating:5},
                {name:"Mai", text:"Tuy·ªát v·ªùi cho b·ªØa s√°ng.", rating:4},
                {name:"Quang", text:"B·ªè nhi·ªÅu rau, t∆∞∆°i.", rating:4},
                {name:"Linh", text:"N∆∞·ªõc s·ªët ƒë·∫≠m ƒë√†.", rating:5},
                {name:"H√πng", text:"Ph·ª•c v·ª• th√¢n thi·ªán.", rating:4}
            ], rating:4.5},
            { id:3, name:"B√∫n Ch·∫£", img:"images/Menu/Buncha/Buncha.jpg", desc:"B√∫n ch·∫£ l√† m·ªôt m√≥n ƒÉn c·ªßa Vi·ªát Nam, bao g·ªìm b√∫n, ch·∫£ th·ªãt l·ª£n n∆∞·ªõng tr√™n than hoa v√† b√°t n∆∞·ªõc m·∫Øm chua cay m·∫∑n ng·ªçt. M√≥n ƒÉn xu·∫•t x·ª© t·ª´ mi·ªÅn B·∫Øc Vi·ªát Nam, l√† th·ª© qu√† c√≥ s·ª©c s·ªëng l√¢u b·ªÅn nh·∫•t c·ªßa H√† N·ªôi, n√™n c√≥ th·ªÉ coi ƒë√¢y l√† m·ªôt trong nh·ªØng ƒë·∫∑c s·∫£n ƒë·∫∑c tr∆∞ng c·ªßa ·∫©m th·ª±c H√† th√†nh. B√∫n ch·∫£ c√≥ n√©t t∆∞∆°ng t·ª± m√≥n b√∫n th·ªãt n∆∞·ªõng ·ªü mi·ªÅn Trung v√† mi·ªÅn Nam, nh∆∞ng n∆∞·ªõc m·∫Øm pha c√≥ v·ªã thanh nh·∫π h∆°n.", variants:[{name:"Th·ªãt n·∫°c", img:"images/Menu/Buncha/thitnac.jpg"},{name:"Th·ªãt m·ª°", img:"images/Menu/Buncha/thitmo.jpg"}], toppings:[{name:"ƒêu ƒë·ªß chua ng·ªçt", img:"images/Menu/TOPPING/dudu.jpg"},{name:"Rau th∆°m", img:"images/Menu/TOPPING/rauthom.jpg"}], comments:[
                {name:"H√πng", text:"ƒê·∫≠m ƒë√† h∆∞∆°ng than.", rating:5},
                {name:"Mai", text:"Ch·∫•m r·∫•t v·ª´a mi·ªáng.", rating:4},
                {name:"Vy", text:"Qu√°n ƒë√¥ng gi·ªù tr∆∞a.", rating:4},
                {name:"Ng·ªçc", text:"S·∫Ω gi·ªõi thi·ªáu cho b·∫°n b√®.", rating:5}
            ], rating:4.6},
            { id:4, name:"Nem r√°n", img:"images/Menu/Nemran/nemran.jpg", desc:"Nem r√°n (hay ch·∫£ gi√≤, ch·∫£ ram hay ch·∫£ ƒëa nem) l√† t√™n m·ªôt m√≥n ƒÉn n·ªïi ti·∫øng c·ªßa ng∆∞·ªùi Vi·ªát, ch√∫ng c≈©ng ƒë∆∞·ª£c g·ªçi t·∫Øt l√† nem theo c√°ch g·ªçi ph·ªï bi·∫øn ·ªü mi·ªÅn B·∫Øc. ·ªû mi·ªÅn Trung, m√≥n ƒÉn n√†y th∆∞·ªùng g·ªçi l√† ram (ri√™ng ·ªü Thanh H√≥a g·ªçi l√† ch·∫£), c√≤n ·ªü mi·ªÅn Nam, n√≥ ƒë∆∞·ª£c g·ªçi l√† ch·∫£ gi√≤.", variants:[{name:"Nem chay", img:"images/Menu/Nemran/nemchay.jpg"},{name:"Nem th·ªãt", img:"images/Menu/Nemran/nemthit.jpg"}], toppings:[{name:"T∆∞∆°ng", img:"images/Menu/TOPPING/tuongot.jpg"},{name:"·ªöt", img:"images/Menu/TOPPING/ot.jpg"}], comments:[
                {name:"B·∫£o", text:"Gi√≤n r·ª•m!", rating:5},
                {name:"Thu", text:"Nh√¢n nhi·ªÅu v√† ƒë·∫≠m v·ªã.", rating:4},
                {name:"T√∫", text:"ƒÇn k√®m rau s·ªëng h·ª£p l√Ω.", rating:4},
                {name:"H√†", text:"M√≥n khai v·ªã tuy·ªát.", rating:5},
                {name:"Thanh", text:"Ph√π h·ª£p m·ªçi l·ª©a tu·ªïi.", rating:4}
            ], rating:4.3},
            { id:6, name:"B√∫n b√≤ Hu·∫ø", img:"images/Menu/BunboHue/bunbohue.jpg", desc:"B√∫n b√≤ Hu·∫ø l√† m·ªôt trong nh·ªØng ƒë·∫∑c s·∫£n c·ªßa th√†nh ph·ªë Hu·∫ø, m·∫∑c d√π m√≥n b√∫n n√†y ph·ªï bi·∫øn tr√™n c·∫£ ba mi·ªÅn ·ªü Vi·ªát Nam v√† c·∫£ ng∆∞·ªùi Vi·ªát t·∫°i h·∫£i ngo·∫°i. T·∫°i Th·ª´a Thi√™n Hu·∫ø, m√≥n n√†y ƒë∆∞·ª£c g·ªçi ƒë∆°n gi·∫£n l√† b√∫n b√≤ ho·∫∑c g·ªçi c·ª• th·ªÉ h∆°n l√† b√∫n b√≤ th·ªãt b√≤. C√°c ƒë·ªãa ph∆∞∆°ng kh√°c g·ªçi l√† b√∫n b√≤ Hu·∫ø, b√∫n b√≤ g·ªëc Hu·∫ø ƒë·ªÉ ch·ªâ xu·∫•t x·ª© c·ªßa m√≥n ƒÉn n√†y.", variants:[{name:"B√∫n b√≤ t√°i", img:"images/Menu/BunboHue/bunbotai.jpg"},{name:"B√∫n b√≤ chay", img:"images/Menu/BunboHue/bunbochay.jpg"}], toppings:[{name:"Huy·∫øt", img:"images/Menu/TOPPING/Huyet.jpg"},{name:"H√†nh l√°", img:"images/Menu/TOPPING/hanhla.jpg"},{name:"·ªöt", img:"images/Menu/TOPPING/ot.jpg"}], comments:[
                {name:"Hu·ªá", text:"V·ªã cay chu·∫©n Hu·∫ø.", rating:5},
                {name:"Long", text:"N∆∞·ªõc d√πng ƒë·∫≠m ƒë√†.", rating:4},
                {name:"H√πng", text:"Th·ªãt m·ªÅm.", rating:4},
                {name:"V√¢n", text:"N√™m v·ª´a ƒÉn.", rating:4},
                {name:"Nam", text:"Kh·∫©u v·ªã mi·ªÅn Trung r√µ r·ªát.", rating:5}
            ], rating:4.4},
            { id:7, name:"B√°nh b·ªôt l·ªçc", img:"images/Menu/banhbotloc/img.jpg", desc:"B√°nh b·ªôt l·ªçc l√† m·ªôt m√≥n ƒÉn truy·ªÅn th·ªëng c·ªßa Vi·ªát Nam, c√≥ ngu·ªìn g·ªëc t·ª´ Hu·∫ø. M√≥n b√°nh n√†y ph·ªï bi·∫øn ·ªü c√°c t·ªânh mi·ªÅn Trung nh∆∞ Ngh·ªá An, ƒê√† N·∫µng,Qu·∫£ng Tr·ªã v√† ƒë·∫∑c bi·ªát l√† Hu·∫ø. ƒê√¢y kh√¥ng ch·ªâ l√† m·ªôt m√≥n ƒÉn v·∫∑t m√† c√≤n mang ƒë·∫≠m gi√° tr·ªã vƒÉn h√≥a v√† l·ªãch s·ª≠ c·ªßa ng∆∞·ªùi Vi·ªát.", variants:[{name:"B√°nh b·ªôt l·ªçc g√≥i l√°", img:"images/Menu/banhbotloc/botlocgoila.jpg"},{name:"B√°nh b·ªôt l·ªçc tr·∫ßn", img:"images/Menu/banhbotloc/botloctran.jpg"}], toppings:[{name:"H√†nh Phi", img:"images/Menu/TOPPING/hanhphi.jpg"},{name:"M·ª° h√†nh", img:"images/Menu/TOPPING/mohanh.jpg"},{name:"C·ªëm", img:"images/Menu/TOPPING/com.jpg"},{name:"N∆∞·ªõc m·∫Øm", img:"images/Menu/TOPPING/nuocmam.jpg"},{name:"Gi√° ƒë·ªó", img:"images/Menu/TOPPING/mohanh.jpg"}], comments:[
                {name:"H∆∞∆°ng", text:"Nh√¢n ƒë·∫ßy ƒë·∫∑n.", rating:5},
                {name:"Lan", text:"V·ªã ngon truy·ªÅn th·ªëng.", rating:4},
                {name:"Khoa", text:"Ph√π h·ª£p ƒÉn nh·∫π.", rating:4},
                {name:"Ti·∫øn", text:"G√≥i ƒë·∫πp m·∫Øt.", rating:4},
                {name:"Ph∆∞∆°ng", text:"ƒÇn n√≥ng ngon h∆°n.", rating:5}
            ], rating:4.5},
            { id:8, name:"B√∫n H·∫øn", img:"images/Menu/bunhen/bunhen.jpg", desc:"B√∫n h·∫øn l√† m√≥n ƒÉn d√¢n d√£, ƒë·∫∑c s·∫£n c·ªßa v√πng ƒë·∫•t C·ªë ƒê√¥ Hu·∫ø v√† ƒë·∫∑c bi·ªát l√† l√†ng Mai X√° (Qu·∫£ng Tr·ªã). Theo truy·ªÅn th·ªëng, b√∫n h·∫øn ƒë∆∞·ª£c ph√°t tri·ªÉn t·ª´ m√≥n b√∫n th·ªãt n∆∞·ªõng c·ªßa ng∆∞·ªùi Hu·∫ø v√†o th·∫ø k·ª∑ XIX. Nh∆∞ng khi ng∆∞·ªùi Hu·∫ø kh√¥ng c√≥ ƒë·ªß th·ªãt ƒë·ªÉ l√†m b√∫n, h·ªç ƒë√£ s·ª≠ d·ª•ng s√≤ h·∫øn thay th·∫ø. T·ª´ ƒë√≥, b√∫n h·∫øn ƒë√£ ra ƒë·ªùi v√† tr·ªü th√†nh m√≥n ƒÉn n·ªïi ti·∫øng c·ªßa v√πng ƒë·∫•t n√†y.", variants:[{name:"C∆°m h·∫øn", img:"images/Menu/Bunhen/comhen.jpg"},{name:"Ch√°o h·∫øn", img:"images/Menu/Bunhen/chaohen.jpg"}], toppings:[{name:"H√†nh l√°", img:"images/Menu/TOPPING/hanhla.jpg"},{name:"M·ª° h√†nh", img:"images/Menu/TOPPING/mohanh.jpg"},{name:"C·ªëm", img:"images/Menu/TOPPING/com.jpg"},{name:"N∆∞·ªõc m·∫Øm", img:"images/Menu/TOPPING/nuocmam.jpg"},{name:"Gi√° ƒë·ªó", img:"images/Menu/TOPPING/mohanh.jpg"}], comments:[
                {name:"Th·∫°ch", text:"√¥i th√¥i r·ªìi", rating:5},
                {name:"Hi·∫øu", text:"V·ªã ngon truy·ªÅn th·ªëng.", rating:4},
                {name:"Minh", text:"Ph√π h·ª£p ƒÉn t·ªëi.", rating:4},
                {name:"Ki·ªát", text:"Kh√° h·ª£p v·ªã.", rating:4},
                {name:"B·∫£o", text:"ƒÇn n√≥ng ngon nh·∫•t.", rating:5}
            ], rating:4.5}
        ];

        const slidesEl = document.getElementById('slides');
        const dotsEl = document.getElementById('dots');
        const slideCount = slidesEl.children.length;
        let current = 0;
        for(let i=0;i<slideCount;i++){
            const d = document.createElement('div'); d.className='dot'; if(i===0) d.classList.add('active');
            d.dataset.index = i;
            d.addEventListener('click', ()=>{ goTo(parseInt(d.dataset.index)); resetAuto(); });
            dotsEl.appendChild(d);
        }
        function updateDots(){ [...dotsEl.children].forEach((d,i)=>d.classList.toggle('active', i===current)); }
        function goTo(i){
            current = (i+slideCount)%slideCount;
            slidesEl.style.transform = `translateX(-${current*100}%)`;
            updateDots();
        }
        document.getElementById('prev').addEventListener('click', ()=>{ goTo(current-1); resetAuto(); });
        document.getElementById('next').addEventListener('click', ()=>{ goTo(current+1); resetAuto(); });

        let autoId = setInterval(()=> goTo(current+1), 5000);
        function resetAuto(){ clearInterval(autoId); autoId = setInterval(()=> goTo(current+1), 5000); }

        document.querySelectorAll('.tab-btn').forEach(btn=>{
            btn.addEventListener('click', ()=>{
                document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
                btn.classList.add('active');
                const tgt = btn.dataset.target;
                document.querySelectorAll('.pane').forEach(p=>p.classList.remove('active'));
                document.getElementById(tgt).classList.add('active');
            });
        });

        const grid = document.getElementById('menuGrid');
        function renderGrid(list){
            grid.innerHTML='';
            list.forEach((d,i)=>{
                const card = document.createElement('article');
                card.className='card reveal';
                card.style.setProperty('--d', `${Math.min(i, 20)*30}ms`);
                card.dataset.id = d.id;
                const truncatedDesc = d.desc.length > 100 ? d.desc.substring(0, 100) + '...' : d.desc;
                card.innerHTML = `
                    <div class="imgwrap"><img src="${d.img}" alt="${d.name}"></div>
                    <h3>${d.name}</h3>
                    <p>${truncatedDesc}</p>
                    <div class="comment-preview" aria-live="polite" tabindex="0">
                        <div class="cavatar" aria-hidden="true"></div>
                        <div class="cmeta"><div class="cname"></div><div class="ctext"></div></div>
                    </div>
                `;
                card.addEventListener('click', ()=> openDish(d.id));
                grid.appendChild(card);

                (function initCardComments(cardEl, data){
                    const comments = Array.isArray(data.comments) ? data.comments : [];
                    const cavatar = cardEl.querySelector('.cavatar');
                    const cname = cardEl.querySelector('.cname');
                    const ctext = cardEl.querySelector('.ctext');
                    const preview = cardEl.querySelector('.comment-preview');

                    if(!comments.length){
                        cname.textContent = 'Ch∆∞a c√≥ b√¨nh lu·∫≠n';
                        ctext.innerHTML = '';
                        cavatar.textContent = '';
                        return;
                    }

                    ctext.innerHTML = '';
                    comments.forEach(c=>{
                        const item = document.createElement('div');
                        item.className = 'citem';
                        item.textContent = c.text;
                        ctext.appendChild(item);
                    });

                    const deriveName = (c, i)=>{
                        if(c && c.name) return String(c.name).slice(0,24);
                        const parts = String(c?.text || '').trim().split(/[.!?‚Ä¶]/)[0].split(' ').slice(0,2).join(' ');
                        return parts || `Ng∆∞·ªùi ${i+1}`;
                    };

                    let idx = 0;
                    function updateMeta(i){
                        const clamped = (i + comments.length) % comments.length;
                        const name = deriveName(comments[clamped], clamped);
                        cname.textContent = name;
                        cavatar.textContent = (name.trim().charAt(0) || 'U').toUpperCase();
                        idx = clamped;
                    }

                    let raf = null, scrollEndTimer = null;
                    function onScroll(){
                        if(raf) cancelAnimationFrame(raf);
                        raf = requestAnimationFrame(()=>{
                            const itemEl = ctext.querySelector('.citem');
                            const h = itemEl ? itemEl.offsetHeight : 48;
                            const newIdx = Math.round(ctext.scrollTop / h);
                            updateMeta(newIdx);
                        });
                        if(scrollEndTimer) clearTimeout(scrollEndTimer);
                        scrollEndTimer = setTimeout(()=>{
                            const itemEl = ctext.querySelector('.citem');
                            const h = itemEl ? itemEl.offsetHeight : 48;
                            const snapIdx = Math.round(ctext.scrollTop / h);
                            ctext.scrollTo({ top: snapIdx * h, behavior:'smooth' });
                        }, 120);
                    }

                    ctext.addEventListener('scroll', onScroll, { passive:true });
                    preview.addEventListener('keydown', (ev)=>{
                        const itemEl = ctext.querySelector('.citem');
                        const h = itemEl ? itemEl.offsetHeight : 48;
                        if(ev.key === 'ArrowDown' || ev.key === 'PageDown'){ ctext.scrollBy({ top: h, behavior:'smooth'}); ev.preventDefault(); }
                        if(ev.key === 'ArrowUp' || ev.key === 'PageUp'){ ctext.scrollBy({ top: -h, behavior:'smooth'}); ev.preventDefault(); }
                    });

                    ctext.scrollTop = 0;
                    updateMeta(0);
                })(card, d);
              });
          }
         renderGrid(dishes);

        const searchInp = document.getElementById('search');
        searchInp.addEventListener('input', (e)=>{
            const q = e.target.value.trim().toLowerCase();
            if(!q){ renderGrid(dishes); return; }
            const matched = [], other=[];
            for(const d of dishes){
                if(d.name.toLowerCase().includes(q)) matched.push(d); else other.push(d);
            }
            renderGrid([...matched, ...other]);
        });

        const modal = document.getElementById('modal');
        const dlgTitle = document.getElementById('dlgTitle');
        const dlgImg = document.getElementById('dlgImg');
        const dlgDesc = document.getElementById('dlgDesc');
        const dlgVars = document.getElementById('dlgVars');
        const dlgTops = document.getElementById('dlgTops');
        const dlgComments = document.getElementById('dlgComments');
        const dlgRating = document.getElementById('dlgRating');
        document.getElementById('closeDlg').addEventListener('click', ()=> modal.classList.remove('active'));
        modal.addEventListener('click', (e)=> { if(e.target===modal) modal.classList.remove('active'); });

        // H√†m t·∫°o HTML cho c√°c ng√¥i sao ƒë√°nh gi√°
        function starsHtml(n){
            const full = Math.round(n);
            return '‚òÖ'.repeat(full) + '‚òÜ'.repeat(5-full) + ` <span style="color:#888;font-weight:600;margin-left:8px">${n.toFixed(1)}/5</span>`;
        }

        // H√†m m·ªü v√† ƒëi·ªÅn d·ªØ li·ªáu v√†o modal
        function openDish(id){
            const d = dishes.find(x=>x.id===id);
            if(!d) return;
            dlgTitle.textContent = d.name;
            dlgImg.src = d.img;
            dlgDesc.textContent = d.desc;            
            dlgRating.innerHTML = starsHtml(d.rating);

            const createChip = (item) => {
                const chip = document.createElement('div');
                chip.className = 'chip';
                chip.textContent = item.name;
                chip.style.position = 'relative';

                const preview = document.createElement('img');
                preview.className = 'chip-preview';
                preview.src = item.img;
                preview.alt = item.name;
                chip.appendChild(preview);

                chip.addEventListener('mouseenter', () => {
                    preview.style.opacity = '1';
                    preview.style.transform = 'translateX(-50%) scale(1)';
                });
                chip.addEventListener('mouseleave', () => {
                    preview.style.opacity = '0';
                    preview.style.transform = 'translateX(-50%) scale(0.9)';
                });
                return chip;
            };

            dlgVars.innerHTML = '';
            d.variants.forEach(v => dlgVars.appendChild(createChip(v)));
            dlgTops.innerHTML = '';
            d.toppings.forEach(t => dlgTops.appendChild(createChip(t)));

            dlgComments.innerHTML = d.comments.map(c=>{
                const name = c.name || (String(c.text||'').split(/[.!?‚Ä¶]/)[0].split(' ').slice(0,2).join(' ')) || 'Ng∆∞·ªùi d√πng';
                const initial = (name.trim().charAt(0) || 'U').toUpperCase();
                const rstars = (typeof c.rating === 'number') ? ('<div style="color:#f5a623;font-size:14px">'+ '‚òÖ'.repeat(Math.round(c.rating)) + '‚òÜ'.repeat(5-Math.round(c.rating)) + '</div>') : '';
                return `<div class="cmt"><div style="display:flex;gap:10px;align-items:flex-start"><div style="width:40px;height:40px;border-radius:50%;background:linear-gradient(180deg,var(--accent),#5f9b6a);color:#fff;display:grid;place-items:center;font-weight:700">${initial}</div><div><strong>${escapeHtml(name)}</strong>${rstars}<div style="margin-top:6px;color:#333">${escapeHtml(c.text)}</div></div></div></div>`;
            }).join('');
            modal.classList.add('active');
        }

        const reviewList = document.getElementById('reviewList');
        function renderReviews(){
             reviewList.innerHTML = '';
             dishes.slice().forEach(d=>{
                 const r = document.createElement('div'); r.className='review-item';
                r.style.cursor = 'pointer';
                r.dataset.id = d.id;
                r.addEventListener('click', ()=> openDish(d.id));
                 const stars = '‚òÖ'.repeat(Math.round(d.rating)) + '‚òÜ'.repeat(5 - Math.round(d.rating));
                 r.innerHTML = `<div><strong>${d.name}</strong><div style="color:#888;font-size:13px">${d.rating.toFixed(1)} / 5</div></div><div style="font-size:18px;color:#f5a623">${stars}</div>`;
                 reviewList.appendChild(r);
             });
         }
        renderReviews();

        const carousel = document.getElementById('carousel');
        let isDragging = false, startX = 0, startTime = 0, basePct = 0;

        function getX(evt){
            if(evt.touches && evt.touches[0]) return evt.touches[0].clientX;
            if(evt.changedTouches && evt.changedTouches[0]) return evt.changedTouches[0].clientX;
            return evt.clientX;
        }

        function onPointerDown(e){
            if(e.target.closest('.control-btn') || e.target.closest('.dots')) return;
            isDragging = true;
            startX = getX(e);
            startTime = Date.now();
            basePct = -current * 100;
            slidesEl.style.transition = 'none';
            carousel.classList.add('grabbing');
            clearInterval(autoId);
            e.preventDefault();
        }
        function onPointerMove(e){
            if(!isDragging) return;
            const dx = getX(e) - startX;
            const pct = (dx / carousel.clientWidth) * 100;
            slidesEl.style.transform = `translateX(calc(${basePct}% + ${pct}%))`;
        }
        function onPointerUp(e){
            if(!isDragging) return;
            isDragging = false;
            carousel.classList.remove('grabbing');
            slidesEl.style.transition = '';
            const dx = getX(e) - startX;
            const dt = Date.now() - startTime;
            const threshold = Math.min(80, carousel.clientWidth * 0.15); // px
            const fast = dt < 220 && Math.abs(dx) > 20;
            if(Math.abs(dx) > threshold || fast){
                if(dx > 0) goTo(current - 1); else goTo(current + 1);
            } else {
                goTo(current);
            }
            resetAuto();
        }

        carousel.addEventListener('pointerdown', onPointerDown, {passive:false});
        window.addEventListener('pointermove', onPointerMove, {passive:true});
        window.addEventListener('pointerup', onPointerUp, {passive:true});
        carousel.addEventListener('touchstart', onPointerDown, {passive:false});
        carousel.addEventListener('touchmove', onPointerMove, {passive:false});
        carousel.addEventListener('touchend', onPointerUp, {passive:true});

        carousel.addEventListener('mouseenter', ()=> clearInterval(autoId));
        carousel.addEventListener('mouseleave', ()=> resetAuto());

        resetAuto();

        function escapeHtml(s){
            return String(s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
        }
    </script>
</body>
</html>
